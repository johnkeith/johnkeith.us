
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>John Keith</title>
  <meta name="author" content="John Keith">

  
  <meta name="description" content="It started as an innocuous attempt to dry up some controller code. 1
2
3
4
5
6
# app/controllers/export_controller.rb if ENV[&#39;TORQUEBOX_APP_TYPE &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://johnk.herokuapp.com/blog">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="John Keith" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44707486-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">John Keith</a></h1>
  
    <h2>Developer - Ruby, Rails, Angular, iOS</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
  
</ul>

<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/atom.xml" class="nav-link">RSS</a></li>
<!--   <li><a href="/about-me/">About Me</a></li> -->
  <li><a href="/portfolio/">Portfolio</a></li>
  <li><a href="http://github.com/johnkeith">Github</a></li>
  <li><a href="https://www.linkedin.com/in/johnterrellkeith">Linkedin</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/11/defining-a-method-accessible-from-anywhere-in-a-rails-app/">Defining a Method Accessible From Anywhere in a Rails App</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-11T19:56:11-04:00" pubdate data-updated="true">Apr 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It started as an innocuous attempt to dry up some controller code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/controllers/export_controller.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_TYPE&#39;</span><span class="o">].</span><span class="n">present?</span> <span class="o">||</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_NAME&#39;</span><span class="o">].</span><span class="n">present?</span>
</span><span class='line'>  <span class="c1"># do some crazy stuff in a background process since this is clearly running in production</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="c1"># Rails must be running locally, so do it in the foreground</span>
</span></code></pre></td></tr></table></div></figure>


<p>I noticed that the same <code>if</code> statement was used in our config/application.rb to setup the correct logging when Torquebox is running. After searching the rest of the code and seeing the same logic was present in config/environments/development.rb I mistakenly thought, &ldquo;It can&rsquo;t be too hard to figure out how to have a method accessible from anywhere in a Rails app.&rdquo;</p>

<p>How wrong I was!</p>

<p>That said, I came up with two possible solutions. The first was to create a proc, stuff it in a global variable, and then access that from each of the places I needed (the config files and the controller).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vg">$torquebox_running</span> <span class="o">=</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_TYPE&#39;</span><span class="o">].</span><span class="n">present?</span> <span class="o">||</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_NAME&#39;</span><span class="o">].</span><span class="n">present?</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>While the proc worked, I didn&rsquo;t think it was the best solution for two structural reasons.</p>

<ol>
<li><p>It would have to be defined in application.rb in order to be used in the start up process, but being defined in that file outside of the Application class (so that it could be accessed elsewhere in the app) would be a tad strange.</p></li>
<li><p>Usage wise, the syntax of $torquebox_running.call seemed a bit strained to me.</p></li>
</ol>


<p>My gut told me that I might be breaking every law in the book by declaring a global proc during the boot-up process of a Rails app. So I decided on a more compartmentalized (though still perhaps not object-oriented) approach to solving the problem.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># lib/services/torquebox_information_service.rb</span>
</span><span class='line'><span class="k">module</span> <span class="nn">TorqueboxInformationService</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="nb">self</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">env_vars_present?</span>
</span><span class='line'>      <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_TYPE&#39;</span><span class="o">].</span><span class="n">present?</span> <span class="o">||</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;TORQUEBOX_APP_NAME&#39;</span><span class="o">].</span><span class="n">present?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">process_running?</span>
</span><span class='line'>      <span class="c1"># not working, needs refinement</span>
</span><span class='line'>      <span class="n">process_pid</span> <span class="o">=</span> <span class="no">Process</span><span class="o">.</span><span class="n">pid</span>
</span><span class='line'>      <span class="n">process_info</span> <span class="o">=</span> <span class="sb">`ps -ef | grep </span><span class="si">#{</span><span class="n">process_pid</span><span class="si">}</span><span class="sb">`</span>
</span><span class='line'>      <span class="n">process_info</span><span class="o">.</span><span class="n">downcase</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;torquebox&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># config/application.rb</span>
</span><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;../../lib/services/torquebox_information_service&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>By wrapping these environment checking methods inside a module and using the handy <code>extend self</code>, the logic was kept isolated and no awful globals created in the process.</p>

<p>I then required the module in the application.rb above all other requirements and the Application class in order that it would be available in every part of the app (config files, models, controllers, the whole gaggle of them!). So far, this approach is working and allows the logic for checking if Torquebox is running to be stored in a single place.</p>

<p>I still feel like this could be improved, though. Maybe by not using <code>extend self</code> and instead including the module on any of the classes that need access to these methods it would better keep these Torquebox logic confined to only the places in the app that need access?</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/23/ajax-testing-using-rspec/">Ajax Testing Using RSpec, Capybara, and Puffing Billy</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-23T09:02:38-04:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Launch Academy has come to an end. It was an incredible 10 weeks, but I&rsquo;m already itching to jump into a new project while beginning my developer job search.</p>

<p>Ajax testing was one of the areas I only briefly touched on at the end of the course so I wanted to spend some time this week exploring the ins and outs of this crucial aspect of testing. The engineers at Launch said that Ajax and other key Javascript operations of an app should be tested using a <a href="http://jasmine.github.io/">JavaScript testing framework</a>. I&rsquo;m still tempted, however, see benefits to testing interactions that rely on Ajax with integration tests, especially if they are fundamental to a user&rsquo;s experience on the page. The example below is how I implemented a couple of Ajax tests using the GitHub API and a simple form.</p>

<p>To start with, it is important to note that testing JavaScript requires you to add some extra configuration in your rails_helper and in your specs. Capybara by default uses the Selenium javascript driver to test Javascript on the page. From my initial testing, it seems like Selenium returns consistent results, but takes more time than other methods. Selenium opens a new instance of the browser for each test, which on a big test suite I imagine could lead to considerable delay.</p>

<p>To enable Javascript on a test, simply pass the <code>js: true</code> option to the test. (Or better yet, pass <code>js: true</code> to your entire feature to use Javascript on all the tests in a spec). When you run RSpec, you should see browser windows pop up and replay the actions mapped out in your integration tests.</p>

<p>There are other Javascript drivers, <a href="https://github.com/teampoltergeist/poltergeist">Poltergeist</a> being the second one I implemented. Poltergeist needs a little extra setup to get it running, as it is built upon <a href="http://phantomjs.org/">PhantomJS</a>, which allows it to run your tests without opening new browser windows each time.</p>

<p>First, add Poltergeist to your Gemfile.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;poltergeist&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, in your rails_helper, specify the default javascript driver to be used in your tests.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">javascript_driver</span> <span class="o">=</span> <span class="ss">:poltergeist</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, make sure either a single test or your entire feature has Javascript enabled by passing the <code>js: true</code> option.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">require_relative</span> <span class="s1">&#39;../rails_helper&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">feature</span> <span class="s2">&quot;user enters basic information on homepage&quot;</span><span class="p">,</span> <span class="ss">js</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, install PhantomJS from the link above. When running RSpec, you should see your test suite function as normal, without browser windows materializing all over the screen.</p>

<p>One major issue that arises with these two approaches is API calls. When using these Javascript drivers on their own, the test suite is still reaching out and making API requests. At first I thought I was safe &ndash; I had <a href="https://github.com/vcr/vcr">VCR</a> and <a href="https://github.com/bblimke/webmock">WebMock</a> enabled in order to record and replay HTTP interactions. I found out the old fashioned way &ndash; by disconnecting from my wi-fi and causing the tests to fail &ndash; that these mechanisms were  in fact not capturing my Ajax requests.</p>

<p>To grab these Ajax requests, I hunted down a gem called <a href="https://github.com/oesmith/puffing-billy">Puffing Billy</a>. Puffing Billy handles the recording of Ajax calls like VCR, allowing you to run the test suite with genuine API requests once and then subsequently replay the recordings made from the first calls. Puffing Billy has a great readme on its GitHub page, but below are the steps I followed to get it working.</p>

<p>First, add Puffing Billy to your Gemfile.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;puffing-billy&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, require Puffing Billy in your rails_helper.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;billy/rspec&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, set your default Javascript driver in your rails_helper. (Puffing Billy supports Selenium, Poltergeist, and Webkit. See the docs for more details.)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">javascript_driver</span> <span class="o">=</span> <span class="ss">:poltergeist_billy</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lastly, configure Puffing Billy to cache Ajax interactions with this configure block in your rails_helper.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Billy</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache_request_headers</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">ignore_params</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;http://www.google-analytics.com/__utm.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;https://r.twimg.com/jot&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://p.twitter.com/t.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://p.twitter.com/f.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://www.facebook.com/plugins/like.php&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;https://www.facebook.com/dialog/oauth&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://cdn.api.twitter.com/1/urls/count.json&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">path_blacklist</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">persist_cache</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">ignore_cache_port</span> <span class="o">=</span> <span class="kp">true</span> <span class="c1"># defaults to true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_successful_cache_disabled</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_successful_error_level</span> <span class="o">=</span> <span class="ss">:warn</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_whitelisted_requests_disabled</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache_path</span> <span class="o">=</span> <span class="s1">&#39;spec/req_cache/&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>That should be it! Now you can run your test suite, watch it pass, and see a folder of the requests in req_cache.</p>

<p>Below is an example of a basic feature I wrote for what I believe is the world&rsquo;s first, only, and hopefully last GitHub dating app. (Not sure I&rsquo;ll be continuing with that side project&hellip;but it was a good example for learning Ajax testing). I&rsquo;ll also include all the necessary configs you need to get RSpec, Capybara, and Puffing Billy to run these test.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># onboarding page feature</span>
</span><span class='line'>
</span><span class='line'><span class="n">require_relative</span> <span class="s1">&#39;../rails_helper&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">feature</span> <span class="s2">&quot;user enters basic information on homepage&quot;</span><span class="p">,</span> <span class="ss">js</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">scenario</span> <span class="s2">&quot;fills in github username&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">visit</span> <span class="n">root_path</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">&quot;johnkeith&quot;</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;gender-select&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_xpath</span> <span class="s2">&quot;//img[@src=</span><span class="se">\&quot;</span><span class="s2">https://avatars.githubusercontent.com/u/4976905?</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_css</span> <span class="s2">&quot;div.has-success&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">scenario</span> <span class="s2">&quot;fills in a github username that doesn&#39;t exist&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">visit</span> <span class="n">root_path</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">&quot;notaghuser&quot;</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;gender-select&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_content</span> <span class="s2">&quot;Sorry, that is not a Github username.&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_css</span> <span class="s2">&quot;div.has-error&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">scenario</span> <span class="s2">&quot;selects own gender&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">visit</span> <span class="n">root_path</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;gender-select&quot;</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">&quot;johnkeith&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_css</span> <span class="s2">&quot;div.has-success&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">scenario</span> <span class="s2">&quot;selects preference for matches&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">visit</span> <span class="n">root_path</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Men&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;match-pref-select&quot;</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">&quot;johnkeith&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_css</span> <span class="s2">&quot;div.has-success&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">scenario</span> <span class="s2">&quot;fills username, selects gender, selects preferences&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">visit</span> <span class="n">root_path</span>
</span><span class='line'>    <span class="n">fill_in</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="s2">&quot;johnkeith&quot;</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;gender-select&quot;</span>
</span><span class='line'>    <span class="nb">select</span> <span class="s2">&quot;Women&quot;</span><span class="p">,</span> <span class="ss">from</span><span class="p">:</span> <span class="s2">&quot;match-pref-select&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_xpath</span> <span class="s2">&quot;//img[@src=</span><span class="se">\&quot;</span><span class="s2">https://avatars.githubusercontent.com/u/4976905?</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_select</span><span class="p">(</span><span class="s2">&quot;gender-select&quot;</span><span class="p">,</span> <span class="ss">selected</span><span class="p">:</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_select</span><span class="p">(</span><span class="s2">&quot;match-pref-select&quot;</span><span class="p">,</span> <span class="ss">selected</span><span class="p">:</span> <span class="s2">&quot;Women&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># rails_helper.rb</span>
</span><span class='line'>
</span><span class='line'><span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;RAILS_ENV&quot;</span><span class="o">]</span> <span class="o">||=</span> <span class="s1">&#39;test&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;spec_helper&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">&quot;../../config/environment&quot;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rspec/rails&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/rails&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;shoulda/matchers&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/poltergeist&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;billy/rspec&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Dir</span><span class="o">[</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;spec/support/**/*.rb&quot;</span><span class="p">)</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="nb">require</span> <span class="n">f</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span><span class="o">.</span><span class="n">maintain_test_schema!</span>
</span><span class='line'>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">javascript_driver</span> <span class="o">=</span> <span class="ss">:poltergeist_billy</span>
</span><span class='line'>
</span><span class='line'><span class="no">Billy</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache_request_headers</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">ignore_params</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;http://www.google-analytics.com/__utm.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;https://r.twimg.com/jot&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://p.twitter.com/t.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://p.twitter.com/f.gif&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://www.facebook.com/plugins/like.php&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;https://www.facebook.com/dialog/oauth&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;http://cdn.api.twitter.com/1/urls/count.json&quot;</span><span class="o">]</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">path_blacklist</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">persist_cache</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">ignore_cache_port</span> <span class="o">=</span> <span class="kp">true</span> <span class="c1"># defaults to true</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_successful_cache_disabled</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_successful_error_level</span> <span class="o">=</span> <span class="ss">:warn</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">non_whitelisted_requests_disabled</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">cache_path</span> <span class="o">=</span> <span class="s1">&#39;spec/req_cache/&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># spec_helper.rb</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;webmock/rspec&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">WebMock</span><span class="o">.</span><span class="n">disable_net_connect!</span><span class="p">(</span><span class="n">allow_localhost</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="no">RSpec</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Gemfile</span>
</span><span class='line'>
</span><span class='line'><span class="n">group</span> <span class="ss">:development</span><span class="p">,</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;dotenv-rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;rspec-rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;capybara&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;launchy&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;factory_girl_rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;pry-rails&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;poltergeist&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;puffing-billy&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;webmock&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;valid_attribute&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;shoulda-matchers&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="c">/ home page with form to be tested</span>
</span><span class='line'>
</span><span class='line'><span class="nc">.row</span>
</span><span class='line'>  <span class="nc">.col-md-3</span>
</span><span class='line'>    <span class="nc">.portrait-placeholder</span>
</span><span class='line'>      <span class="nt">%img</span><span class="p">{</span> <span class="ss">src</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;img-responsive img-thumbnail&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;github-avatar&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="nc">.col-md-9</span>
</span><span class='line'>    <span class="nt">%form</span><span class="p">{</span> <span class="ss">role</span><span class="p">:</span> <span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;onboard-form&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="nc">.form-group.form-group-lg</span><span class="nf">#github-username-group</span>
</span><span class='line'>        <span class="nt">%input</span><span class="p">{</span> <span class="ss">type</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;form-control input-lg&quot;</span><span class="p">,</span> <span class="ss">placeholder</span><span class="p">:</span> <span class="s2">&quot;Your Github username&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;github-username&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="nc">.form-group.form-group-lg</span><span class="nf">#gender-group</span>
</span><span class='line'>        <span class="nt">%select</span><span class="p">{</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;form-control input-lg&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;gender-select&quot;</span> <span class="p">}</span>
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;selected&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;selected&quot;</span> <span class="p">}</span> Select your gender
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;male&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;gender-male&quot;</span> <span class="p">}</span> Male
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;gender-female&quot;</span> <span class="p">}</span> Female
</span><span class='line'>      <span class="nc">.form-group.form-group-lg</span><span class="nf">#match-group</span>
</span><span class='line'>        <span class="nt">%select</span><span class="p">{</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;form-control input-lg&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;match-pref-select&quot;</span> <span class="p">}</span>
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;selected&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;selected&quot;</span> <span class="p">}</span> Select your preference
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;men&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;match-men&quot;</span> <span class="p">}</span> Men
</span><span class='line'>          <span class="nt">%option</span><span class="p">{</span> <span class="ss">value</span><span class="p">:</span> <span class="s2">&quot;women&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;match-women&quot;</span> <span class="p">}</span> Women
</span><span class='line'>    <span class="nc">.form-errors</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// jquery for form </span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;https://api.github.com/users/&quot;</span> <span class="o">+</span> <span class="nx">username</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-avatar&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">avatar_url</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username-group&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;has-success&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username-group&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;has-error&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.form-errors&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.form-errors&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;Sorry, that is not a Github username.&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-avatar&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username-group&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;has-error&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#github-username-group&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;has-success&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#gender-select&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#gender-group&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;has-success&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#match-pref-select&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#match-group&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;has-success&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/22/week-six-and-embracing-tdd/">Week Six and Embracing TDD</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-22T19:41:39-04:00" pubdate data-updated="true">Jun 22<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We have made it to the end of week six. It was a big one for me:</p>

<ul>
<li>Pushed a <a href="http://unodos.herokuapp.com">Javascript game to Heroku</a></li>
<li>Promptly got hacked</li>
<li>Started figuring out OmniAuth</li>
<li>Finally surmounted my fear/distaste for Test Driven Development.</li>
</ul>


<p>TDD was one of the big aspects of the move to Rails that I was dreading. During our phase working in Sinatra, we didn&rsquo;t worry about TDD &ndash; it was enough trying to wrap our heads around the basics of HTTP, Postgres, and ActiveRecord. Now that we are building with Rails in ernest, TDD has moved to the foreground of our development process.</p>

<p>Initially, I was very wary of TDD. The Launch instructors did a great job of demonstrating the rationale behind TDD, showing us how TDD can ensure against your changes in one part of an app breaking another part, which was one thing that never quite sunk in for me working through tutorials online. That said, some of my early fumbling through Capybara and Rspec left me hesitant about TDD.</p>

<p>When we started TDD, I shied away from the assignments, focusing on a side project in Javascript. We finally finished that Javascript game on Friday, turning it into a Sinatra app that we were able to put up on Heroku, and this weekend I resolved to put in the time to get comfortable using TDD.</p>

<p>Having spent the past two days building a first Rails app from the ground up with TDD, my perspective has certainly changed. When you strictly adhere to the TDD methodology, it makes the process of building an app (especially a Rails app by hand, without scaffolding, as was the assignment this weekend) much more approachable and logical. My final product hardly had comprehensive test coverage, but now I feel comfortable with using TDD as a guide for building an app piece by piece.</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/15/how-ive-learned-in-five-short/">How I&#8217;ve Learned in Five Short Weeks at Launch</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-15T21:20:25-04:00" pubdate data-updated="true">Jun 15<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We are now officially halfway through our ten weeks at Launch. What I&rsquo;m still marveling at after five weeks is how Launch Academy is transforming me as a learner.</p>

<p>Pre-Launch, back in high school and college, I was a very learn-by-the-book kind of guy. I would read cover to cover any text put in front of me, but asking me to jump into a topic or domain without much preparation beforehand was always a struggle.</p>

<p>One great part about learning web development is that the read first, execute later approach I relied on in the past does not work. I&rsquo;ve felt myself constantly challenged the past few weeks to dive into projects knowing only enough to get started and then to seek out only the knowledge I need to complete to reach the goal.</p>

<p>Fundamentally, I guess this is what makes project-based learning powerful: the fact that the knowledge you acquire is all acquired in a specific context of doing or creating. Even as I&rsquo;ve started to head off on tangents of my own, like diving deeply into Javascript prototypes last week, this learning is done to serve a purpose, to bring some piece of functionality into existence.</p>

<p>If you want to take the metaphor perhaps a little too far (which is always a fun exercise), it is almost like the project-based curriculum of Launch is OOP for your brain. Sure, you can gather knowledge together in your mind about a certain object, but these little tarballs of information are worthless until you start defining behaviors and passing messages between them. Knowledge as an object in and of itself does nothing &ndash; it is only once it starts to interact with other bits of information that the effect is meaningful.</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/09/week-four-and-the-challenges-of-oop/">Week Four and the Challenges of OOP</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-09T07:32:47-04:00" pubdate data-updated="true">Jun 9<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Week four saw us moving into object oriented programming fully, a move that has certainly come with its share of challenges.</p>

<p>What I&rsquo;m finding most challenging about OOP is figuring out how to reorient an app once it has gotten off track. A friend and I started working on a game a little over a week ago, back before we were really comfortable with OOP, and this week our lack of discipline and underlying structure has become more and more apparent as our code base has ballooned.</p>

<p><img src="http://gdurl.com/2q7r" alt="UnoDos" /></p>

<p>(It&rsquo;s amazing how quickly the complexity of a game, even a simple one, can get out of hand). Certainly, working on the game has been a great exercise, though, for struggling through the realities of OOP.</p>

<p>We also started moving into ActiveRecord last week, initially building some of the pieces ourselves and then seeing how ActiveRecord makes the process of interacting with a database much more enjoyable. This week we&rsquo;ll be beginning with Rails, so I&rsquo;m excited to be getting back into it and diving into the nitty gritty details. Already, with all of our work the past few weeks, I feel much more prepared to figure out how Rails really works than I ever did learning on my own.</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/01/week-three-and-designing-for-efficiency/">Week Three and Designing for Efficiency</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-01T19:31:07-04:00" pubdate data-updated="true">Jun 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Week three of Launch Academy was a short one with the holiday on Monday, but we covered a lot of ground. It was the start of the second module in the curriculum and we dove headfirst into databases this week. The relation database we are using right now is Postgres, which has been a nice change from the static data storage in CSV files we were using in weeks one and two.</p>

<p>We also had a great speaker come this week &ndash; <a href="https://twitter.com/PDegenPortnoy">Peter Degen-Portnoy</a>. He gave us a brief introduction to object oriented design, which will be the focus of our work this week.</p>

<p>Outside of our core material last week, I spent time wresting with problems of efficiency. I found myself still mulling over mechanics from the 2048 code I wrote in week two, looking for ways to improve the efficiency of the logic used to find random empty spaces on the game board. I knew our initial way was not ideal &ndash; it determined random X and Y coordinates on the board and checked to see if that space was empty. Eventually, I ended up benchmarking three different ways of finding a random empty space in a matrix and I believe I found a reasonably efficient way to go about it. (It is the middle method of the three below, which gives consistently better results, often taking half the time of the other two).</p>

<p>My goal is to continue thinking along these lines this week &ndash; learning about how to incorporate object oriented design into our apps while keeping an eye out for writing efficient code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">test_board</span> <span class="o">=</span> <span class="o">[[</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>              <span class="o">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>              <span class="o">[</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;8&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>              <span class="o">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;8&quot;</span><span class="o">]]</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">insertRandomly</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
</span><span class='line'>  <span class="n">two_or_four</span> <span class="o">=</span> <span class="nb">rand</span><span class="o">.</span><span class="n">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">2</span>
</span><span class='line'>  <span class="n">insert_successful</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="k">while</span> <span class="o">!</span><span class="n">insert_successful</span>
</span><span class='line'>    <span class="n">random_position_one</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</span><span class='line'>    <span class="n">random_position_two</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">board</span><span class="o">[</span><span class="n">random_position_one</span><span class="o">][</span><span class="n">random_position_two</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span>
</span><span class='line'>      <span class="n">board</span><span class="o">[</span><span class="n">random_position_one</span><span class="o">][</span><span class="n">random_position_two</span><span class="o">]</span> <span class="o">=</span> <span class="n">two_or_four</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>      <span class="n">insert_successful</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">insertLessRandomly</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
</span><span class='line'>  <span class="n">two_or_four</span> <span class="o">=</span> <span class="nb">rand</span><span class="o">.</span><span class="n">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">2</span>
</span><span class='line'>  <span class="n">random_direction</span> <span class="o">=</span> <span class="nb">rand</span><span class="o">.</span><span class="n">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="kp">true</span> <span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">insert_successful</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="k">while</span> <span class="o">!</span><span class="n">insert_successful</span>
</span><span class='line'>    <span class="n">random_position_one</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</span><span class='line'>    <span class="n">empty_space</span> <span class="o">=</span> <span class="kp">nil</span>
</span><span class='line'>    <span class="n">empty_space</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">random_position_one</span><span class="o">].</span><span class="n">find_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
</span><span class='line'>      <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">empty_space</span> <span class="o">!=</span> <span class="kp">nil</span>
</span><span class='line'>      <span class="n">board</span><span class="o">[</span><span class="n">random_position_one</span><span class="o">][</span><span class="n">empty_space</span><span class="o">]</span> <span class="o">=</span> <span class="n">two_or_four</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>      <span class="n">insert_successful</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">insertByIndex</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
</span><span class='line'>  <span class="n">two_or_four</span> <span class="o">=</span> <span class="nb">rand</span><span class="o">.</span><span class="n">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">2</span>
</span><span class='line'>  <span class="n">empty_spaces</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="n">board</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="p">,</span> <span class="n">row_index</span><span class="o">|</span>
</span><span class='line'>    <span class="n">row</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">column</span><span class="p">,</span> <span class="n">col_index</span><span class="o">|</span>
</span><span class='line'>      <span class="n">empty_spaces</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="n">row_index</span><span class="p">,</span> <span class="n">col_index</span><span class="o">]</span> <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">select_empty</span> <span class="o">=</span> <span class="n">empty_spaces</span><span class="o">.</span><span class="n">sample</span>
</span><span class='line'>  <span class="n">board</span><span class="o">[</span><span class="n">select_empty</span><span class="o">[</span><span class="mi">0</span><span class="o">]][</span><span class="n">select_empty</span><span class="o">[</span><span class="mi">1</span><span class="o">]]</span> <span class="o">=</span> <span class="n">two_or_four</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  

</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
</nav>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - John Keith -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'johnkeith';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script>
  $(document).ready(function() {  
    var stickyNavTop = $('nav').offset().top;  
      
    var stickyNav = function(){  
      var scrollTop = $(window).scrollTop(); 
      var navHasClassSticky = $('nav').hasClass('sticky');

      if (scrollTop > stickyNavTop && navHasClassSticky) {   
        return true;
      } else if (scrollTop > stickyNavTop) {
        $('nav').hide();
        $('nav').addClass('sticky');
        $('nav').fadeIn('2000');
      } else {  
        $('nav').removeClass('sticky');   
      }  
    };  
      
    stickyNav();  
      
    $(window).scroll(function() {  
      stickyNav();  
    });  
  });  
</script>

<script>
th_username = "johnkeith";
th_show_all_badges = false;
th_number_badges_visible = (9 - 1);

$(document).ready(function() {

  if(th_username == "" || th_show_all_badges == false && th_number_badges_visible == -1){
    $(".badges-box").hide();
  } else {

  $.getJSON("http://teamtreehouse.com/" + th_username +".json", function(data) {
    var items = [];
    var number_of_badges = data.badges.length;
    var total_points = data.points.total;
    $.each(data.badges, function(k, v) {
       items.push( "<a href='" + v.url + "'><img src='" + v.icon_url + "' alt='" + v.name + "' title='" + v.name + "'/></a>");
    });
   
    $(".badges-box").append("<p>I've earned <strong>" + number_of_badges + " badges</strong> for a total of <strong>" + total_points + " points</strong> at <a href='http://www.teamtreehouse.com'>Treehouse!</a></p>");
   
    $( "<ul/>", {
      "class": "badge-image-list",
      html: items.reverse().join( "" )
    }).appendTo( ".badges-box" ).hide().fadeIn(500);
   
    if(th_show_all_badges == false) {
      $( ".badge-image-list img:gt(" + th_number_badges_visible + ")").hide();

      $(".badges-box").append("<button id='show-all'>See all badges</button>");

      $("#show-all").click(function() {
        $( ".badge-image-list img:gt(" + th_number_badges_visible + ")").toggle(0, "linear");
        if($("#show-all").html() == "See all badges") {
          $("#show-all").html("Hide badges");
          $("#show-all").blur();
        } else {
          $("#show-all").html("See all badges");
          $("#show-all").blur();
        };
      });
    };
  });
 };
});
</script>


</body>
</html>
